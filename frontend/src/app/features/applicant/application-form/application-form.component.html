<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h4 class="mb-0">
            <i class="fas fa-file-alt me-2"></i>
            Nouvelle Demande d'Adhésion
          </h4>
        </div>
        <div class="card-body">
          <!-- Success Message -->
          <div *ngIf="submitSuccess" class="alert alert-success" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            {{ submitSuccess }}
          </div>

          <!-- Error Message -->
          <div *ngIf="submitError" class="alert alert-danger" role="alert">
            <i class="fas fa-exclamation-circle me-2"></i>
            {{ submitError }}
          </div>

          <form [formGroup]="applicationForm" (ngSubmit)="onSubmit()" novalidate>
            <!-- Institution Details Info -->
            <div class="alert alert-info">
              <h6><i class="fas fa-info-circle me-2"></i>Informations importantes</h6>
              <p class="mb-0">
                Cette demande sera liée à votre établissement enregistré. 
                Assurez-vous de fournir tous les détails nécessaires pour faciliter le traitement.
              </p>
            </div>

            <!-- Application Details -->
            <div class="mb-3">
              <label for="details" class="form-label">
                <strong>Détails de la demande d'adhésion *</strong>
              </label>
              <textarea
                id="details"
                class="form-control"
                formControlName="details"
                rows="6"
                placeholder="Décrivez votre établissement, vos activités, le nombre d'employés, les raisons de votre demande d'adhésion à la FM6..."
                [class.is-invalid]="details?.invalid && details?.touched"
                [class.is-valid]="details?.valid && details?.touched">
              </textarea>
              
              <!-- Character Counter -->
              <div class="form-text">
                {{ details?.value?.length || 0 }}/1000 caractères
                (minimum 50 caractères requis)
              </div>

              <!-- Validation Messages -->
              <div *ngIf="details?.invalid && details?.touched" class="invalid-feedback">
                <div *ngIf="details?.errors?.['required']">
                  Les détails de la demande sont obligatoires.
                </div>
                <div *ngIf="details?.errors?.['minlength']">
                  Les détails doivent contenir au moins 50 caractères.
                </div>
                <div *ngIf="details?.errors?.['maxlength']">
                  Les détails ne peuvent pas dépasser 1000 caractères.
                </div>
              </div>
            </div>

            <!-- Documents Upload -->
            <div class="mb-3">
              <label for="documents" class="form-label">
                <strong>Documents justificatifs</strong>
                <small class="text-muted">(optionnel)</small>
              </label>
              <input
                type="file"
                id="documents"
                class="form-control"
                (change)="onFileSelected($event)"
                accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                multiple>
              <div class="form-text">
                Formats acceptés: PDF, DOC, DOCX, JPG, PNG (max 10MB par fichier)
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="d-flex justify-content-between">
              <button
                type="button"
                class="btn btn-secondary"
                routerLink="/applicant/dashboard">
                <i class="fas fa-arrow-left me-2"></i>
                Retour au tableau de bord
              </button>
              
              <button
                type="submit"
                class="btn btn-primary"
                [disabled]="isSubmitting || applicationForm.invalid">
                <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2" role="status">
                  <span class="visually-hidden">Chargement...</span>
                </span>
                <i *ngIf="!isSubmitting" class="fas fa-paper-plane me-2"></i>
                {{ isSubmitting ? 'Soumission en cours...' : 'Soumettre la demande' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>